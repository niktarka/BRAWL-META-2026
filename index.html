<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>BRAWL CALIBRATOR 2026 | SKILL CHECK (PRO)</title>
  <!-- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏–Ω–∫‚Äë—Ç–µ–≥–∏ –∫ —à—Ä–∏—Ñ—Ç–∞–º (—É–±—Ä–∞–Ω—ã –≥–æ–ª—ã–µ URL-—Å—Ç—Ä–æ–∫–∏, –ª–æ–º–∞–≤—à–∏–µ –≤–µ—Ä—Å—Ç–∫—É) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">

  <style>
    /* --- DESIGN UNTOUCHED AS REQUESTED --- */
    :root {
      --bg-dark: #050507;
      --glass: rgba(255,255,255,0.05);
      --glass-border: rgba(255,255,255,0.1);
      --neon-cyan: #00f3ff;
      --neon-red: #ff003c;
      --neon-gold: #ffd700;
      --text-main: #e0e0e0;
      --text-muted: #8a8a8a;
    }
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Rajdhani',sans-serif;}
    body{
      background-color:var(--bg-dark);
      background-image:
        radial-gradient(circle at 10% 20%, rgba(0,243,255,.05) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(255,0,60,.05) 0%, transparent 20%);
      color:var(--text-main);min-height:100vh;display:flex;justify-content:center;align-items:center;overflow-x:hidden;
    }
    .container{width:100%;max-width:600px;padding:20px;perspective:1000px;}
    .card{
      background:var(--glass);backdrop-filter:blur(15px);-webkit-backdrop-filter:blur(15px);
      border:1px solid var(--glass-border);border-radius:20px;padding:40px 30px;
      box-shadow:0 0 30px rgba(0,0,0,.5);position:relative;overflow:hidden;transition:all .5s ease;
    }
    h1,h2,h3{font-family:'Orbitron',sans-serif;text-transform:uppercase;letter-spacing:2px;}
    h1{font-size:2rem;text-align:center;margin-bottom:10px;text-shadow:0 0 10px var(--neon-cyan);}
    .subtitle{ text-align:center;color:var(--text-muted);margin-bottom:30px;font-size:.9rem;}

    .btn{
      background:transparent;border:1px solid var(--neon-cyan);color:var(--neon-cyan);
      padding:15px 30px;font-size:1.2rem;font-weight:700;cursor:pointer;text-transform:uppercase;width:100%;
      margin-top:20px;transition:.3s;clip-path:polygon(10% 0,100% 0,100% 70%,90% 100%,0 100%,0 30%);
    }
    .btn:hover:not(:disabled){background:var(--neon-cyan);color:var(--bg-dark);box-shadow:0 0 20px var(--neon-cyan);}
    .btn:disabled{border-color:var(--text-muted);color:var(--text-muted);cursor:not-allowed;}

    .input-group{position:relative;margin-bottom:20px;}
    .brawl-input{
      width:100%;padding:15px;background:rgba(0,0,0,.3);border:1px solid var(--glass-border);
      color:#fff;font-size:1.1rem;border-radius:8px;transition:.3s;
    }
    .brawl-input:focus{outline:none;border-color:var(--neon-cyan);box-shadow:0 0 10px rgba(0,243,255,.2);}
    .brawl-input.locked{border-color:var(--neon-gold);color:var(--neon-gold);background:rgba(255,215,0,.05);pointer-events:none;}
    .edit-icon{position:absolute;right:15px;top:50%;transform:translateY(-50%);cursor:pointer;color:var(--neon-gold);display:none;}

    .search-results{
      position:absolute;top:100%;left:0;width:100%;background:#0a0a0f;border:1px solid var(--glass-border);
      z-index:100;max-height:200px;overflow-y:auto;display:none;
    }
    .search-item{padding:12px;display:flex;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,.05);cursor:pointer;transition:.2s;}
    .search-item:hover{background:rgba(0,243,255,.1);color:var(--neon-cyan);}

    .screen{display:none;opacity:0;transform:translateX(50px);transition:all .5s ease;}
    .screen.active{display:block;opacity:1;transform:translateX(0);}

    select.brawl-input{appearance:none;cursor:pointer;}

    .roster-grid{display:grid;gap:10px;max-height:300px;overflow-y:auto;padding-right:5px;}
    .roster-row{display:flex;gap:10px;align-items:center;}
    .roster-num{color:var(--text-muted);font-family:'Orbitron';width:32px;}

    .verdict-box{text-align:center;}
    .score-display{font-size:6rem;font-family:'Orbitron';font-weight:900;line-height:1;margin:20px 0;}
    .verdict-text{font-size:1.5rem;margin-bottom:20px;font-weight:bold;}
    .advice-box{background:rgba(255,255,255,.05);padding:20px;border-left:4px solid var(--neon-cyan);text-align:left;margin-top:20px;}

    .hint{margin-top:15px;font-size:.85rem;color:var(--text-muted);border-left:2px solid var(--neon-red);padding-left:10px;}

    /* Boot screen bits */
    .boot-log{
      background:rgba(0,0,0,.3);border:1px solid var(--glass-border);border-radius:10px;
      font-family:'Rajdhani',monospace;font-size:.95rem;color:#cfefff;padding:12px;min-height:80px;max-height:120px;overflow:auto;
    }
    .boot-bar{margin-top:12px;height:10px;background:rgba(255,255,255,.06);border:1px solid var(--glass-border);border-radius:6px;overflow:hidden;}
    .boot-bar-fill{height:100%;width:0;background:linear-gradient(90deg,var(--neon-cyan),#7fffff);box-shadow:0 0 12px var(--neon-cyan) inset;transition:width .2s ease;}

    ::-webkit-scrollbar{width:5px;}
    ::-webkit-scrollbar-track{background:#050507;}
    ::-webkit-scrollbar-thumb{background:var(--neon-cyan);}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>Brawl Meta 2026</h1>
      <p class="subtitle">Skill Calibration System v.3.4 PRO [AUDIO ENABLED]</p>

      <!-- SCREEN 0: BOOT / START -->
      <div id="screen-boot" class="screen active">
        <h2>00 // SYSTEM BOOT</h2>
        <div class="boot-log" id="boot-log"></div>
        <div class="boot-bar"><div class="boot-bar-fill" id="boot-bar"></div></div>
        <button class="btn" id="btn-start" disabled onclick="startApp()">–ù–ê–ß–ê–¢–¨</button>
      </div>

      <!-- SCREEN 1 -->
      <div id="screen-main" class="screen">
        <h2>01 // IDENTIFICATION</h2>
        <p style="margin-bottom: 20px; color: var(--text-muted);">–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç 40% —Ç–≤–æ–µ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø–æ —ç—Ç–æ–º—É –≤—ã–±–æ—Ä—É.</p>

        <label>–ö–¢–û –¢–í–û–ô –ú–ï–ô–ù (–õ–£–ß–®–ò–ô –ë–û–ï–¶)?</label>
        <div class="input-group">
          <input type="text" id="main-input" class="brawl-input" placeholder="–ù–∞—á–Ω–∏ –≤–≤–æ–¥–∏—Ç—å –∏–º—è..." autocomplete="off">
          <span class="edit-icon" id="main-edit" title="–ò–∑–º–µ–Ω–∏—Ç—å –º–µ–π–Ω–∞" onclick="resetMain()">‚úèÔ∏è</span>
          <div class="search-results" id="main-results"></div>
        </div>

        <div class="hint">
          <strong style="color: var(--neon-red)">–í–ù–ò–ú–ê–ù–ò–ï:</strong> –ï—Å–ª–∏ —Ç—ã –º–µ–π–Ω–∏—à—å –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –≥—Ä—É–ø–ø—ã "Low Skill" (–≠–º–∑, –≠–¥–≥–∞—Ä, –ö–∏—Ç), —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–º–µ–Ω–∏—Ç —à—Ç—Ä–∞—Ñ–Ω–æ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç.
        </div>

        <button class="btn" id="btn-to-roster" disabled onclick="nextScreen('screen-main','screen-roster')">–î–ê–õ–ï–ï</button>
      </div>

      <!-- SCREEN 2 -->
      <div id="screen-roster" class="screen">
        <h2>02 // ELITE ROSTER</h2>
        <p style="margin-bottom: 12px; color: var(--text-muted);">–í–≤–µ–¥–∏ –±–æ–π—Ü–æ–≤ —Å 1000+ –∫—É–±–∫–∞–º–∏ (Rank 30+). –ú–∏–Ω–∏–º—É–º 1.</p>

        <!-- —á–µ–∫–±–æ–∫—Å ¬´–≤—Å–µ 99 –Ω–∞ –º–∞–∫—Å–µ¬ª -->
        <div class="input-group" style="margin-bottom: 12px; display:flex; align-items:center; gap:10px;">
          <input type="checkbox" id="all-max-toggle" style="width:18px; height:18px; cursor:pointer;">
          <label for="all-max-toggle" style="cursor:pointer; color: var(--text-main);">–£ –º–µ–Ω—è –≤—Å–µ 99 –±–æ–π—Ü–æ–≤ –Ω–∞ –º–∞–∫—Å —Ä–∞–Ω–≥–µ (1000+)</label>
        </div>

        <div class="roster-grid" id="roster-container"></div>

        <div class="hint">
          –°–∏—Å—Ç–µ–º–∞ —Å—á–∏—Ç–∞–µ—Ç <strong>—Å—Ä–µ–¥–Ω—é—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å</strong> —Ç–æ–ª—å–∫–æ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –±–æ–π—Ü–æ–≤. –î—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ –∑–∞—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è.
        </div>

        <button class="btn" id="btn-to-audit" disabled onclick="nextScreen('screen-roster','screen-audit')">–î–ê–õ–ï–ï</button>
      </div>

      <!-- SCREEN 3 -->
      <div id="screen-audit" class="screen">
        <h2>03 // TACTICAL AUDIT (PRO)</h2>
        <p style="margin-bottom: 20px; color: var(--text-muted);">–û—Ç–≤–µ—á–∞–π —á–µ—Å—Ç–Ω–æ. –î–µ—Ç–µ–∫—Ç–æ—Ä –ª–∂–∏ –≤–∫–ª—é—á–µ–Ω.</p>

        <div style="display:flex;flex-direction:column;gap:15px;">
          <!-- –ë–ê–ó–û–í–´–ï -->
          <select id="q1" class="brawl-input">
            <option value="" disabled selected>–¢–∏–ø –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏—è</option>
            <option value="0">Full Auto-Aim (–Ø –∂–º—É –∫—Ä–∞—Å–Ω—É—é –∫–Ω–æ–ø–∫—É)</option>
            <option value="5">–ì–∏–±—Ä–∏–¥ (–í–±–ª–∏–∑–∏ –∞–≤—Ç–æ, –≤–¥–∞–ª–∏ —Å–∞–º)</option>
            <option value="10">Full Manual (–ü—Ä–µ–¥–∏–∫—Ç—ã –º–æ—ë –≤—Å—ë)</option>
          </select>

          <select id="q2" class="brawl-input">
            <option value="" disabled selected>–¢–µ–∫—É—â–∞—è –õ–∏–≥–∞ (Ranked)</option>
            <option value="1">Bronze / Silver</option>
            <option value="3">Gold / Diamond</option>
            <option value="6">Mythic / Legendary</option>
            <option value="10">Masters (–¢–æ–ø –º–∏—Ä–∞)</option>
          </select>

          <select id="q3" class="brawl-input">
            <option value="" disabled selected>–ü–æ–∑–∏—Ü–∏–æ–Ω–∫–∞ –∏ –ú–∞–Ω—Å—ã</option>
            <option value="2">–ò–¥—É –≤–ø–µ—Ä–µ–¥ –∏ —É–º–∏—Ä–∞—é</option>
            <option value="5">–î–µ—Ä–∂—É –ª–∞–π–Ω, –Ω–æ –ª–æ–≤–ª—é —É–ª—å—Ç—ã</option>
            <option value="9">–ò–¥–µ–∞–ª—å–Ω—ã–π —Å–ø—ç–π—Å–∏–Ω–≥, –±–∞–π—á—É –Ω–∞ —É–ª—å—Ç—É</option>
          </select>

          <select id="q4" class="brawl-input">
            <option value="" disabled selected>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ì–∞–¥–∂–µ—Ç–æ–≤</option>
            <option value="2">–ó–∞–±—ã–≤–∞—é –Ω–∞–∂–∞—Ç—å / –ñ–º—É –≤—Å–µ —Å—Ä–∞–∑—É</option>
            <option value="6">–î–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è</option>
            <option value="10">–î–ª—è –∫–æ–º–±–æ-–∫–∏–ª–ª–æ–≤ –∏ –æ—Ç–º–µ–Ω—ã –∞–Ω–∏–º–∞—Ü–∏–π</option>
          </select>

          <select id="q5" class="brawl-input">
            <option value="" disabled selected>–°—Ä–µ–¥–Ω–∏–π –ü–∏–Ω–≥</option>
            <option value="10">0-30ms (LAN-–∫–∞—á–µ—Å—Ç–≤–æ)</option>
            <option value="7">30-70ms (–°—Ç–∞–±–∏–ª—å–Ω–æ)</option>
            <option value="3">100ms+ (–õ–∞–≥–∞–µ—Ç, –Ω–æ —è –ø—Ä–∏–≤—ã–∫)</option>
          </select>
          
          <select id="q6" class="brawl-input">
            <option value="" disabled selected>–£—á–∞—Å—Ç–∏–µ –≤ —Ç—É—Ä–Ω–∏—Ä–∞—Ö</option>
            <option value="0">–¢–æ–ª—å–∫–æ –ª–∞–¥–¥–µ—Ä</option>
            <option value="5">–ú–µ—Å—Ç–Ω—ã–µ —Å–∫—Ä–∏–º—ã –≤ Discord</option>
            <option value="10">Monthly Finals / Pro Play</option>
          </select>

          <!-- –î–û–ü. –¢–û–ß–ù–´–ï -->
          <select id="q7" class="brawl-input">
            <option value="" disabled selected>–ó–Ω–∞–Ω–∏–µ –∫–∞—Ä—Ç –∏ —Ç–∞–π–º–∏–Ω–≥–æ–≤ (–±—Ä–µ–π–∫–∏, –∫—É—Å—Ç—ã, —É–≥–ª—ã)</option>
            <option value="2">–ü—É—Ç–∞—é—Å—å –≤ –º–∞–∫–µ—Ç–µ –∫–∞—Ä—Ç</option>
            <option value="6">–ó–Ω–∞—é —Å–ø–æ—Ç—ã, –∏–Ω–æ–≥–¥–∞ –æ—à–∏–±–∞—é—Å—å</option>
            <option value="10">–ß–∏—Ç–∞—é –∫–∞—Ä—Ç—ã –∏ —Ç–∞–π–º–∏–Ω–≥–∏ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–µ</option>
          </select>

          <select id="q8" class="brawl-input">
            <option value="" disabled selected>–ì–∏–±–∫–æ—Å—Ç—å –ø–æ —Ä–µ–∂–∏–º–∞–º (Bounty/Heist/Hot Zone/Gem/BR)</option>
            <option value="2">–ò–≥—Ä–∞—é 1-2 —Ä–µ–∂–∏–º–∞</option>
            <option value="6">–ö–æ–º—Ñ–æ—Ä—Ç–Ω–æ –≤ 3-4 —Ä–µ–∂–∏–º–∞—Ö</option>
            <option value="10">–£–≤–µ—Ä–µ–Ω–Ω–æ –≤–æ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–∞—Ö</option>
          </select>

          <select id="q9" class="brawl-input">
            <option value="" disabled selected>–î—Ä–∞—Ñ—Ç –∏ –ø–∏–∫–∏ (–ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–µ—Ç—ã/—Å–∏–Ω–µ—Ä–≥–∏–π)</option>
            <option value="2">–ë–µ—Ä—É –ª—é–±–∏–º—ã—Ö</option>
            <option value="6">–£—á–∏—Ç—ã–≤–∞—é –∫–∞—Ä—Ç—ã/–ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤</option>
            <option value="10">–°–∏—Å—Ç–µ–º–Ω–æ –≤—ã–∏–≥—Ä—ã–≤–∞—é –¥—Ä–∞—Ñ—Ç</option>
          </select>

          <select id="q10" class="brawl-input">
            <option value="" disabled selected>–ö–æ–Ω—Ç—Ä-–ø–∏–∫–∏ (–∑–Ω–∞–Ω–∏–µ –º–∞—Ç—á–∞–ø–æ–≤)</option>
            <option value="2">–ù–µ —Ä–∞–∑–ª–∏—á–∞—é –º–∞—Ç—á–∞–ø—ã</option>
            <option value="6">–ó–Ω–∞—é –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ç—Ä—ã</option>
            <option value="10">–¢–æ–Ω–∫–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É—é —Å–ª–∞–±–æ—Å—Ç–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞</option>
          </select>

          <select id="q11" class="brawl-input">
            <option value="" disabled selected>–ö–æ–º–∞–Ω–¥–Ω–∞—è –∫–æ–º–º-—Ü–∏—è (–∫–æ–ª–ª—ã, —Ä–æ—Ç–∞—Ü–∏–∏)</option>
            <option value="2">–ò–≥—Ä–∞—é —Å–æ–ª–æ</option>
            <option value="6">–ò–Ω–æ–≥–¥–∞ –∫–æ–ª–ª—é</option>
            <option value="10">–ß–µ—Ç–∫–∏–π —à–æ—Ç–∫–æ–ª–ª/—Å–∏–Ω—Ö—Ä–æ–Ω</option>
          </select>

          <select id="q12" class="brawl-input">
            <option value="" disabled selected>–§–æ–∫—É—Å –Ω–∞ —Ü–µ–ª–∏ —Ä–µ–∂–∏–º–∞ (–≥–µ–º—ã, —Å–µ–π—Ñ, —Ç–æ—á–∫–∏)</option>
            <option value="2">–ì–æ–Ω—è—é—Å—å –∑–∞ –∫–∏–ª–ª–∞–º–∏</option>
            <option value="6">–ò–Ω–æ–≥–¥–∞ —Ç–µ—Ä—è—é —Ñ–æ–∫—É—Å</option>
            <option value="10">–í—Å–µ–≥–¥–∞ –∏–≥—Ä–∞—é –ø–æ —Ü–µ–ª–∏</option>
          </select>

          <select id="q13" class="brawl-input">
            <option value="" disabled selected>–¢–æ—á–Ω–æ—Å—Ç—å —Å—Ç—Ä–µ–ª—å–±—ã (—Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞)</option>
            <option value="2">&lt;40%</option>
            <option value="6">40-60%</option>
            <option value="10">60%+</option>
          </select>

          <select id="q14" class="brawl-input">
            <option value="" disabled selected>–¢—Ä–µ–∫–∏–Ω–≥ –±–æ–µ–ø—Ä–∏–ø–∞—Å–æ–≤ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞</option>
            <option value="2">–ù–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é</option>
            <option value="6">–ò–Ω–æ–≥–¥–∞ —Å–ª–µ–∂—É</option>
            <option value="10">–î–µ—Ä–∂—É –≤ –≥–æ–ª–æ–≤–µ –≤—Å–µ–≥–¥–∞</option>
          </select>

          <select id="q15" class="brawl-input">
            <option value="" disabled selected>–≠–∫–æ–Ω–æ–º–∏–∫–∞ —É–ª—å—Ç—ã (–∫–æ–ø–ª—é/—Ç—Ä–∞—á—É –ø–æ –ø–ª–∞–Ω—É)</option>
            <option value="2">–ñ–º—É –∫–∞–∫ –ø–æ—è–≤–∏—Ç—Å—è</option>
            <option value="6">–ò–Ω–æ–≥–¥–∞ –¥–µ—Ä–∂—É –ø–æ–¥ –º–æ–º–µ–Ω—Ç</option>
            <option value="10">–£–ª—å—Ç–∞ ‚Äî —Ä–µ—Å—É—Ä—Å –ø–æ–¥ –∑–∞–¥–∞—á—É</option>
          </select>
        </div>

        <button class="btn" onclick="calculateResult()">–ü–û–õ–£–ß–ò–¢–¨ –í–ï–†–î–ò–ö–¢</button>
      </div>

      <!-- SCREEN 4 -->
      <div id="screen-result" class="screen">
        <div class="verdict-box">
          <h2 style="color: var(--neon-gold)">ITOG SYSTEM VERDICT</h2>
        <div class="score-display" id="final-score">0</div>
          <div class="verdict-text" id="verdict-title">ANALYZING...</div>
        </div>
        <div class="advice-box" id="advice-text"></div>
        <button class="btn" onclick="location.reload()">–ü–ï–†–ï–ö–ê–õ–ò–ë–†–û–í–ö–ê</button>
      </div>

    </div>
  </div>

  <script>
    // --- 0. AUDIO ENGINE (PURE JS SYNTH) ---
    const AudioFX = {
      ctx:null,
      init(){ if(!this.ctx) this.ctx=new (window.AudioContext||window.webkitAudioContext)(); if(this.ctx.state==='suspended') this.ctx.resume(); },
      beep(type){
        if(!this.ctx) return;
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        osc.connect(gain); gain.connect(this.ctx.destination);
        const now = this.ctx.currentTime;
        if(type==='hover'){
          osc.type='sine'; osc.frequency.setValueAtTime(420,now); osc.frequency.exponentialRampToValueAtTime(860,now+.06);
          gain.gain.setValueAtTime(0.04,now); gain.gain.exponentialRampToValueAtTime(0.001,now+.06);
          osc.start(now); osc.stop(now+.06);
        }else if(type==='click'){
          osc.type='triangle'; osc.frequency.setValueAtTime(220,now); osc.frequency.linearRampToValueAtTime(60,now+.12);
          gain.gain.setValueAtTime(0.09,now); gain.gain.exponentialRampToValueAtTime(0.001,now+.12);
          osc.start(now); osc.stop(now+.12);
        }else if(type==='select'){
          osc.type='square'; osc.frequency.setValueAtTime(600,now); osc.frequency.exponentialRampToValueAtTime(1200,now+.1);
          gain.gain.setValueAtTime(0.05,now); gain.gain.exponentialRampToValueAtTime(0.001,now+.1);
          osc.start(now); osc.stop(now+.1);
        }else if(type==='transition'){
          osc.type='sawtooth'; osc.frequency.setValueAtTime(300,now); osc.frequency.exponentialRampToValueAtTime(900,now+.18);
          gain.gain.setValueAtTime(0.05,now); gain.gain.exponentialRampToValueAtTime(0.001,now+.18);
          osc.start(now); osc.stop(now+.18);
        }else if(type==='poweron'){
          this.note(392,now,0.12,0.10); this.note(523.25,now+.12,0.12,0.10); this.note(659.25,now+.24,0.25,0.12);
        }else if(type==='success'){
          this.note(440,now,.18,.12); this.note(554,now+.12,.18,.12); this.note(659,now+.24,.18,.12);
        }
      },
      note(freq,time,dur=0.2,vol=0.1){
        const osc=this.ctx.createOscillator(), gain=this.ctx.createGain();
        osc.connect(gain); gain.connect(this.ctx.destination);
        osc.type='sine'; osc.frequency.setValueAtTime(freq,time);
        gain.gain.setValueAtTime(vol,time); gain.gain.exponentialRampToValueAtTime(0.001,time+dur);
        osc.start(time); osc.stop(time+dur);
      }
    };
    document.addEventListener('click', ()=>AudioFX.init(), {once:true});
    function wireAudio(){ document.querySelectorAll('button,input,select').forEach(el=>{ if(!el.dataset._a){ el.addEventListener('mouseenter',()=>AudioFX.beep('hover')); el.addEventListener('click',()=>AudioFX.beep('click')); el.dataset._a=1; } }); }
    wireAudio();

    // --- 1. DB ---
    const brawlers = [
      // LEGENDARY
      {name:"Leon",diff:6,tier:"MID"},{name:"Spike",diff:5,tier:"MID"},{name:"Crow",diff:6,tier:"MID"},
      {name:"Sandy",diff:4,tier:"MID"},{name:"Amber",diff:3,tier:"LOW"},{name:"Meg",diff:3,tier:"LOW"},
      {name:"Chester",diff:5,tier:"MID"},{name:"Cordelius",diff:6,tier:"MID"},{name:"Surge",diff:4,tier:"MID"},
      {name:"Kit",diff:1,tier:"LOW"},{name:"Draco",diff:5,tier:"MID"},{name:"Kenji",diff:7,tier:"MID"},
      {name:"Pierce",diff:5,tier:"MID"},{name:"Kaze",diff:8,tier:"MID"},
      // MYTHIC
      {name:"Mortis",diff:5,tier:"MID"},{name:"Tara",diff:6,tier:"MID"},{name:"Gene",diff:6,tier:"MID"},
      {name:"Max",diff:9,tier:"HARD"},{name:"Mr. P",diff:5,tier:"MID"},{name:"Sprout",diff:8,tier:"MID"},
      {name:"Byron",diff:9,tier:"HARD"},{name:"Squeak",diff:4,tier:"MID"},{name:"Eve",diff:6,tier:"MID"},
      {name:"Gray",diff:9,tier:"HARD"},{name:"Willow",diff:7,tier:"MID"},{name:"Doug",diff:3,tier:"LOW"},
      {name:"Chuck",diff:6,tier:"MID"},{name:"Charlie",diff:4,tier:"MID"},{name:"Mico",diff:7,tier:"MID"},
      {name:"Melodie",diff:7,tier:"MID"},{name:"Lily",diff:4,tier:"MID"},{name:"Clancy",diff:4,tier:"MID"},
      {name:"Moe",diff:6,tier:"MID"},{name:"Juju",diff:6,tier:"MID"},{name:"Buster",diff:6,tier:"MID"},
      {name:"Finx",diff:9,tier:"HARD"},{name:"Mina",diff:8,tier:"MID"},{name:"Alli",diff:8,tier:"MID"},
      {name:"Lumi",diff:8,tier:"MID"},{name:"R-T",diff:7.5,tier:"MID"},{name:"Gigi",diff:9,tier:"HARD"},
      {name:"Ruffs",diff:7.5,tier:"MID"},{name:"Lou",diff:7.5,tier:"MID"},{name:"Ollie",diff:7,tier:"MID"},
      {name:"Jae-yong",diff:7,tier:"MID"},{name:"Ziggy",diff:7,tier:"MID"},{name:"Otis",diff:6,tier:"MID"},
      {name:"Janet",diff:5,tier:"MID"},{name:"Fang",diff:3,tier:"LOW"},{name:"Buzz",diff:3,tier:"LOW"},
      {name:"Glowbert",diff:2,tier:"LOW"},
      // EPIC
      {name:"Piper",diff:7,tier:"MID"},{name:"Pam",diff:5,tier:"MID"},{name:"Frank",diff:3,tier:"LOW"},
      {name:"Bibi",diff:6,tier:"MID"},{name:"Bea",diff:4,tier:"MID"},{name:"Nani",diff:10,tier:"HARD"},
      {name:"Edgar",diff:1,tier:"LOW"},{name:"Griff",diff:5,tier:"MID"},{name:"Grom",diff:6,tier:"MID"},
      {name:"Bonnie",diff:5,tier:"MID"},{name:"Gale",diff:4,tier:"MID"},{name:"Colette",diff:6,tier:"MID"},
      {name:"Belle",diff:7,tier:"MID"},{name:"Ash",diff:6,tier:"MID"},{name:"Lola",diff:5,tier:"MID"},
      {name:"Sam",diff:8,tier:"MID"},{name:"Mandy",diff:8,tier:"MID"},{name:"Maisie",diff:7,tier:"MID"},
      {name:"Hank",diff:10,tier:"HARD"},{name:"Pearl",diff:5,tier:"MID"},{name:"Larry & Lawrie",diff:4,tier:"MID"},
      {name:"Angelo",diff:9,tier:"HARD"},{name:"Berry",diff:5,tier:"MID"},{name:"Shade",diff:7,tier:"MID"},
      {name:"Emz",diff:2,tier:"LOW"},{name:"Bo",diff:5,tier:"MID"},{name:"Stu",diff:6,tier:"MID"},
      {name:"Meeple",diff:6,tier:"MID"},
      // SUPER RARE
      {name:"Rico",diff:8,tier:"MID"},{name:"Darryl",diff:5,tier:"MID"},{name:"Penny",diff:5,tier:"MID"},
      {name:"Carl",diff:6,tier:"MID"},{name:"Jacky",diff:2,tier:"LOW"},{name:"Gus",diff:8,tier:"MID"},
      {name:"Dynamike",diff:5,tier:"MID"},{name:"Tick",diff:7,tier:"MID"},{name:"8-Bit",diff:5,tier:"MID"},{name:"Jessie",diff:4,tier:"MID"},
      // RARE
      {name:"El Primo",diff:3,tier:"LOW"},{name:"Barley",diff:7,tier:"MID"},{name:"Poco",diff:5,tier:"MID"},
      {name:"Rosa",diff:2,tier:"LOW"},{name:"Bull",diff:3,tier:"LOW"},{name:"Brock",diff:6,tier:"MID"},
      {name:"Nita",diff:3,tier:"LOW"},{name:"Colt",diff:7,tier:"MID"},
      // STARTING
      {name:"Shelly",diff:2,tier:"LOW"},
      // FUTURE 2026 (flavor)
      {name:"Vortex",diff:8,tier:"MID"},{name:"R-T 2.0",diff:7,tier:"MID"},{name:"Shadow",diff:9,tier:"HARD"}
    ].sort((a,b)=>a.name.localeCompare(b.name));

    const archetypes = {
      sharpshooter:["Colt","Bea","Piper","Brock","Belle","Mandy","Nani"],
      assassin:["Mortis","Edgar","Fang","Buzz"],
      thrower:["Dynamike","Barley","Grom","Sprout"],
      control:["Sandy","Lou","Gale","Janet","Otis","Ruffs"],
      tank:["Bull","El Primo","Frank","Jacky"],
      support:["Poco","Pam","Byron","Gene"],
      gadgeteer:["Gray","Max","Colette","Stu"]
    };
    const getArchetype = (name)=>Object.entries(archetypes).find(([,list])=>list.includes(name))?.[0]||'general';

    // --- 2. STATE ---
    let state = { mainBrawler:null, roster:[], audit:{}, allMax:false };

    // --- 3. DOM & SCREENS ---
    const getEl = (id)=>document.getElementById(id);

    function nextScreen(currentId,nextId){
      if(nextId==='screen-roster' && !state.mainBrawler){ alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –º–µ–π–Ω–∞.'); return; }
      if(nextId==='screen-audit' && state.roster.length===0){ alert('–î–æ–±–∞–≤—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –±–æ–π—Ü–∞ 1000+.'); return; }
      AudioFX.beep('transition');
      getEl(currentId).classList.remove('active');
      setTimeout(()=>{ getEl(currentId).style.display='none'; getEl(nextId).style.display='block';
        setTimeout(()=>{ getEl(nextId).classList.add('active'); wireAudio(); },50);
      },500);
    }

    // --- 0.1 BOOT SIMULATION + START ---
    const bootMessages = [
      '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ‚Äë–¥–≤–∏–∂–∫–∞...',
      '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–∑—ã –±–æ–π—Ü–æ–≤...',
      '–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–π—Ä–æ‚Äë–º–æ–¥—É–ª–µ–π —Ç–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞—É–¥–∏—Ç–∞...',
      '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: –∫–∞—Ä—Ç—ã, —Ä–µ–∂–∏–º—ã, –º–∞—Ç—á–∞–ø—ã...',
      '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...',
      '–ì–æ—Ç–æ–≤–æ. –ú–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å.'
    ];
    const bootLog = getEl('boot-log');
    const bootBar = getEl('boot-bar');
    const btnStart = getEl('btn-start');

    function bootStep(i=0){
      if(i===0){ AudioFX.beep('poweron'); }
      if(i<bootMessages.length){
        bootLog.innerHTML += (bootLog.innerHTML?'<br>':'') + '‚Ä¢ ' + bootMessages[i];
        bootLog.scrollTop = bootLog.scrollHeight;
        bootBar.style.width = Math.round(((i+1)/bootMessages.length)*100)+'%';
        setTimeout(()=>bootStep(i+1), 350);
      }else{
        btnStart.disabled = false;
      }
    }
    function startApp(){ nextScreen('screen-boot','screen-main'); }

    // --- 4. SEARCH (—Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞, –±–µ–∑ —Å–∫–∏–ª–ª-–±–∞–ª–ª–æ–≤) ---
    const mainInput = getEl('main-input');
    const mainResults = getEl('main-results');
    const btnToRoster = getEl('btn-to-roster');
    const mainEdit = getEl('main-edit');

    function handleSearch(query, resultBox, callback){
      resultBox.innerHTML='';
      if(query.length<1){ resultBox.style.display='none'; return; }
      const matches = brawlers.filter(b=>b.name.toLowerCase().startsWith(query.toLowerCase()));
      if(matches.length>0){
        resultBox.style.display='block';
        matches.forEach(b=>{
          const div=document.createElement('div');
          div.className='search-item';
          div.textContent = b.name;              // üëà –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∏–º—è
          div.onclick = ()=>{ AudioFX.beep('select'); callback(b); };
          div.onmouseenter = ()=>AudioFX.beep('hover');
          resultBox.appendChild(div);
        });
      }else{
        resultBox.style.display='none';
      }
    }
    mainInput?.addEventListener('input',(e)=>handleSearch(e.target.value, mainResults, selectMain));

    function selectMain(brawler){
      state.mainBrawler = brawler;
      mainInput.value = brawler.name;
      mainInput.classList.add('locked');
      mainInput.setAttribute('readonly',true);
      mainResults.style.display='none';
      btnToRoster.disabled=false;
      mainEdit.style.display='block';
    }
    function resetMain(){
      state.mainBrawler=null;
      mainInput.value='';
      mainInput.classList.remove('locked');
      mainInput.removeAttribute('readonly');
      btnToRoster.disabled=true;
      mainEdit.style.display='none';
      mainInput.focus();
    }

    // --- 5. ROSTER (99 SLOTS + ¬´ALL MAX¬ª) ---
    const rosterContainer = getEl('roster-container');
    const btnToAudit = getEl('btn-to-audit');
    const allMaxToggle = getEl('all-max-toggle');

    for(let i=0;i<99;i++){
      const row=document.createElement('div');
      row.className='roster-row';
      row.innerHTML=`
        <span class="roster-num">${(i+1).toString().padStart(2,'0')}.</span>
        <div class="input-group" style="width:100%;margin:0;">
          <input type="text" class="brawl-input roster-field" placeholder="–ò–º—è –±–æ–π—Ü–∞..." id="roster-${i}" autocomplete="off">
          <div class="search-results" id="roster-results-${i}"></div>
        </div>`;
      rosterContainer.appendChild(row);

      const input = getEl(`roster-${i}`);
      const results = getEl(`roster-results-${i}`);

      input.addEventListener('input',(e)=>handleSearch(e.target.value, results, (b)=>selectRoster(b,input,results,i)));
      input.addEventListener('focus',()=>{
        if(input.classList.contains('locked')){
          input.value='';
          input.classList.remove('locked');
          input.removeAttribute('readonly');
          state.roster = state.roster.filter(item=>item.index!==i);
          validateRoster();
        }
      });
    }
    wireAudio();

    function selectRoster(brawler, input, results, index){
      if(state.roster.some(r=>r.data.name===brawler.name)){
        alert('–≠—Ç–æ—Ç –±–æ–µ—Ü —É–∂–µ –µ—Å—Ç—å –≤ —Ä–æ—Å—Ç–µ—Ä–µ. –î—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ –∑–∞—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è.');
        return;
      }
      input.value=brawler.name;
      input.classList.add('locked');
      input.setAttribute('readonly',true);
      results.style.display='none';
      state.roster = state.roster.filter(item=>item.index!==index);
      state.roster.push({index, data:brawler});
      validateRoster();
    }
    function validateRoster(){ btnToAudit.disabled = state.roster.length===0; }

    allMaxToggle.addEventListener('change',()=>{ allMaxToggle.checked ? fillAllMax() : clearAllRoster(); });

    function fillAllMax(){
      clearAllRoster(false);
      const count=Math.min(99,brawlers.length);
      for(let i=0;i<99;i++){
        const input=getEl(`roster-${i}`); const results=getEl(`roster-results-${i}`);
        const b = i<count ? brawlers[i] : null;
        if(b){
          input.value=b.name; input.classList.add('locked'); input.setAttribute('readonly',true);
          if(results) results.style.display='none';
          state.roster = state.roster.filter(item=>item.index!==i);
          state.roster.push({index:i,data:b});
        }else{
          input.value=''; input.classList.remove('locked'); input.removeAttribute('readonly');
          state.roster = state.roster.filter(item=>item.index!==i);
        }
      }
      state.allMax = true;
      validateRoster();
    }
    function clearAllRoster(resetToggle=true){
      for(let i=0;i<99;i++){
        const input=getEl(`roster-${i}`); if(!input) continue;
        input.value=''; input.classList.remove('locked'); input.removeAttribute('readonly');
      }
      state.roster = [];
      state.allMax = false;
      validateRoster();
      if(resetToggle) allMaxToggle.checked=false;
    }

    // --- 6. TIPS ---
    const generalTips=[
      '–°–ª–µ–¥–∏ –∑–∞ —Ü–∏–∫–ª–∞–º–∏ —Å–ø–∞–≤–Ω–∞ –≤—Ä–∞–≥–æ–≤: —Ç–∞–π–º –∫–æ–ª–ª–æ–≤ –¥–∞—ë—Ç +1-2 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∫–∏–ª–ª–∞ –Ω–∞ —Ä–æ—Ç–∞—Ü–∏–∏.',
      '–ù–µ –æ—Ç–¥–∞–≤–∞–π —É–ª—å—Ç—É –≤ –≤–æ–∑–¥—É—Ö: –ø–ª–∞–Ω–∏—Ä—É–π —Ç—Ä–µ–π–¥—ã –ø–æ–¥ –∫–ª—é—á–µ–≤—ã–µ —Å–µ–∫—É–Ω–¥—ã —Ä–µ–∂–∏–º–∞ (40s/20s/OT).',
      '–ú–µ–Ω—è–π –≤—ã—Å–æ—Ç—É –ø–æ–∑–∏—Ü–∏–∏: –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –∏ —É–≥–ª—ã —Å–æ–∫—Ä–∞—â–∞—é—Ç –≤—Ä–µ–º—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –ø—Ä–æ—Å—Ç—Ä–µ–ª–µ.',
      '–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–∏–∫–∞–π –æ—Ç–∫—Ä—ã—Ç–æ –ø—Ä–æ—Ç–∏–≤ –¥–∞–ª—å–Ω–∏–∫–æ–≤ ‚Äî —Å—ã–≥—Ä–∞–π –æ—Ç —É–∫—Ä—ã—Ç–∏—è –∏ –¥–æ–∂–¥–∏—Å—å –æ–∫–Ω–∞ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏.',
      '–ö–æ–Ω—Ç—Ä–æ–ª—å –∫—É—Å—Ç–æ–≤ –≤–∞–∂–Ω–µ–µ –ª–∏—à–Ω–µ–≥–æ —É—Ä–æ–Ω–∞: –¥–∏–∑–∞—Ä–º –∏–Ω—Ñ—ã –ª–æ–º–∞–µ—Ç –≤–µ—Å—å –ø–ª–µ–π –≤—Ä–∞–≥–∞.',
      '–ö–æ–ª–ª –±–µ–π—Ç–∞ —É–ª—å—Ç—ã —Å–æ–ø–µ—Ä–Ω–∏–∫–∞: –≤—ã–º–∞–Ω–∏–ª ‚Äî —Å—Ä–∞–∑—É –ø—Ä–æ–ø—É—à—å –¥—Ä—É–≥–æ–π —Ñ–ª–∞–Ω–≥.',
      '–û—Ç—Å–ª–µ–∂–∏–≤–∞–π –≥–∞–¥–∂–µ—Ç—ã —Å–æ–ø–µ—Ä–Ω–∏–∫–∞: –ø–æ—Å–ª–µ 3/3 –æ–Ω —Å–∏–ª—å–Ω–æ —Å–ª–∞–±–µ–µ ‚Äî –º–µ–Ω—è–π —Ç–µ–º–ø.',
      '–í Heist —Ü–µ–Ω–∏—Ç—Å—è –Ω–µ K/D, –∞ —É—Ä–æ–Ω –ø–æ —Å–µ–π—Ñ—É. –ü–ª–∞–Ω–∏—Ä—É–π —Ä–æ—É—Ç—ã —Å –¥–≤–æ–π–Ω—ã–º –¥–∞–≤–ª–µ–Ω–∏–µ–º.',
      '–í Bounty –∏–∑–±–µ–≥–∞–π —Å–æ–ª–æ-–∏–Ω–∏—Ü–∏–∞—Ü–∏–π –ø—Ä–∏ –æ—Ç—Ä—ã–≤–µ –ø–æ –∑–≤—ë–∑–¥–∞–º ‚Äî –∏–≥—Ä–∞–π –æ—Ç —Å–µ–π–≤–∞ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.',
      '–í Gem Grab –ø—Ä–∏ 7+ –≥–µ–º–∞—Ö –∏–≥—Ä–∞–π –æ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–Ω—Ç—Ä–∞ –∏ —Å–µ–π–≤–∞ –∫—ç—Ä—Ä–∏–µ—Ä–∞, –∞ –Ω–µ –æ—Ç –∫–∏–ª–ª–æ–≤.',
      '–í Hot Zone –Ω–µ —Å—Ç–æ–π ¬´–Ω–∞ —Ç–æ—á–∫–µ¬ª –±–µ–∑ –Ω—É–∂–¥—ã ‚Äî –∏–≥—Ä–∞–π –æ—Ç –∫—Ä–∞—ë–≤ –∑–æ–Ω—ã, —Ä–µ–∂—å –ø–æ–¥—Ö–æ–¥—ã.',
      '–£—á–∏—Å—å ¬´–ø–µ—Ä–µ—Å—Ç—Ä–µ–ª–∏–≤–∞—Ç—å¬ª –ø–æ —Ç–∞–π–º–∏–Ω–≥—É –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏ ‚Äî –≤—ã—Ö–æ–¥–∏ —Ä–æ–≤–Ω–æ –≤ –æ–∫–Ω–æ –ø—É—Å—Ç—ã—Ö –ø–∞—Ç—Ä–æ–Ω–æ–≤.',
      '–ù–µ —Ñ–æ—Ä—Å–∏ –ø—É—à, –µ—Å–ª–∏ —Ç–∏–º–º–µ–π—Ç —Ä–µ—Å–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 2-3 —Å–µ–∫—É–Ω–¥—ã ‚Äî –¥–æ–∂–¥–∏—Å—å —Å–∏–Ω—Ö—Ä–æ–Ω–∞.',
      '–ü–æ–¥–±–∏—Ä–∞–π —Å—Ç–∞—Ä–ø–∞—É—ç—Ä—ã –∏ –≥–µ—Ä—ã –ø–æ–¥ –∫–∞—Ä—Ç—É ‚Äî —ç—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –≤–∏–Ω—Ä–µ–π—Ç–∞.',
      '–°–º–µ—â–∞–π –ø—Ä–∏—Ü–µ–ª –≤–ø–µ—Ä—ë–¥ –æ—Ç –º–æ–¥–µ–ª–∏ ‚Äî –ø—Ä–µ–¥–∏–∫—Ç—ã —Ä–µ—à–∞—é—Ç —Ä–∞–Ω–Ω–∏–µ –¥—É—ç–ª–∏.',
      '–ü—Ä–æ—Ç–∏–≤ –ø—Ä—ã–∂–∫–æ–≤—ã—Ö –∞—Å—Å–∞—Å–∏–Ω–æ–≤ –¥–µ—Ä–∂–∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏—é ¬´–ø–æ–ª—Ç–æ—Ä–∞ —Ç–∞–π–ª–∞ + —É–≥–æ–ª¬ª.',
      '–ü—Ä–æ–∏–≥—Ä—ã–≤–∞–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ: –≤—ã—Ö–æ–¥–∏ –∏–∑ –ø–ª–æ—Ö–∏—Ö —Ç—Ä–µ–π–¥–æ–≤ —Å –∏–Ω—Ñ–æ–π –¥–ª—è –∫–æ–º–∞–Ω–¥—ã.',
      '–ó–∞–ø–∏—Å—ã–≤–∞–π –¥–µ–º–∫–∏: –æ—Ç–º–µ—á–∞–π –ø–ª–æ—Ö–æ–π –ø–∏–∫, —Ç–∞–π–º–∏–Ω–≥ –∏ –ø–æ–∑–∏—Ü–∏—é.',
      '–¢–µ–º–ø‚Äë–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç: —Ö—Ä–∞–Ω–∏ –≥–∞–¥–∂–µ—Ç—ã/—É–ª—å—Ç—É –ø–æ–¥ –∫–ª—é—á–µ–≤—ã–µ –∑–∞–º–µ—Å—ã.',
      '–ù–µ –ø—É—à—å —Ü–µ–Ω—Ç—Ä –±–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª—è –±–æ–∫–æ–≤—ã—Ö –∫—É—Å—Ç–æ–≤ ‚Äî —Ä–∞—Å—Ñ–æ–∫—É—Å.'
    ];
    const proTips=[
      '–ü–ª–∞–Ω–∏—Ä—É–π ¬´—Ç–∞–π–º–∏–Ω–≥–∏ –º–æ–ª—á–∞–Ω–∏—è¬ª: 5‚Äì8 —Å–µ–∫—É–Ω–¥ –±–µ–∑ —Å—Ç—Ä–µ–ª—å–±—ã, —á—Ç–æ–±—ã –º–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –ø–æ–¥ –∫–ª—é—á–µ–≤—É—é —Ü–µ–ª—å.',
      '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π —É–ª—å—Ç—ã —Å —Ç–∏–º–º–µ–π—Ç–∞–º–∏: –Ω–∞–∑–Ω–∞—á–∞–π ¬´–ø–µ—Ä–≤—ã–π –≤—Ä—ã–≤¬ª, ¬´–≤—Ç–æ—Ä–æ–π —Ñ–æ–ª–ª–æ—É‚Äë–∞–ø¬ª, ¬´—Ç—Ä–µ—Ç–∏–π —Å–µ–π–≤¬ª.',
      '–ü—Ä–µ–¥–∏–∫—Ç –ø–æ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–µ –≤—Ä–∞–≥–∞: –∑–∞—Ö–æ–¥–∏ –≤ 0.2‚Äì0.4 c –¥–æ –µ–≥–æ –ø–æ–ª–Ω–æ–≥–æ –∫–ª–∏–ø–∞ ‚Äî —à–∞–Ω—Å –Ω–∞ —Ç—Ä–µ–π–¥ ‚Üë.',
      '–ü—Ä–æ–ø–∏—Å—ã–≤–∞–π –±–∞–Ω‚Äë–ª–∏—Å—Ç—ã –ø–æ–¥ –∫–∞—Ä—Ç—ã –∏ —Ä–µ–∂–∏–º—ã –∑–∞—Ä–∞–Ω–µ–µ ‚Äî –º–∏–Ω—É—Å—É—é—Ç –¥–æ 30% —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ—Ä–∞–∂–µ–Ω–∏–π.',
      '–°—á–∏—Ç—ã–≤–∞–π –ø–∞—Ç—Ç–µ—Ä–Ω—ã –º–∞–Ω—Å—ã –ø–æ 2‚Äì3 –¥—É—ç–ª—è–º –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–π —à–∏—Ä–∏–Ω—É —É–≤–æ–¥–æ–≤ –ø—Ä–∏—Ü–µ–ª–∞.',
      '–ú–∏–∫—Ä–æ‚Äë–ª–∏–Ω–∏—é –¥–µ—Ä–∂–∏ –Ω–∞ –ø–æ–ª‚Äë—Ç–∞–π–ª–∞ –¥–∞–ª—å—à–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ ‚Äî —Ä–µ–∂–µ –ª–æ–≤–∏—à—å —à–æ—Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤.'
    ];
    const specificTips={
      'Colt':['–°—Ç–µ–ø‚Äë—à–æ—Ç—ã + —Ä–∏–∫–æ—à–µ—Ç—ã –ø–æ–¥ —É–≥–ª–æ–º 15‚Äì25¬∞ ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –¥—É—ç–ª–µ–π –Ω–∞ –¥–ª–∏–Ω–Ω–æ–π.','–û—Ç–∫—Ä—ã–≤–∞–π —Å—Ç–µ–Ω—ã –ø–æ–¥ —Ç–∞–π–º–∏–Ω–≥–∏ –∑–∞—Ö–æ–¥–∞, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫.','–ö–æ–º–±–∏ ¬´Silver Bullet¬ª + —É–ª—å—Ç–∞ –¥–ª—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è.'],
      'Mortis':['–í—Ö–æ–¥–∏ –Ω–∞ –ø—É—Å—Ç—ã–µ –ø–∞—Ç—Ä–æ–Ω—ã –≤—Ä–∞–≥–∞, –≤—ã—Ö–æ–¥–∏ –ø–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏.','¬´–¢—Ä–æ–π–Ω–æ–π –¥—ç—à¬ª: –¥–≤–∞ –Ω–∞ –≤—Ö–æ–¥ ‚Äî –æ–¥–∏–Ω –Ω–∞ –≤—ã—Ö–æ–¥.'],
      'Dynamike':['–î–≤–æ–π–Ω—ã–µ –≤–∑—Ä—ã–≤—ã: –≤—Ç–æ—Ä–æ–π ‚Äî —Ç—É–¥–∞, –∫—É–¥–∞ —É–π–¥—ë—Ç –≤—Ä–∞–≥ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ.','–ò—Å–ø–æ–ª—å–∑—É–π —Å—Ç–µ–Ω—ã –∫–∞–∫ ¬´–±–∞–Ω–∫–∏¬ª –¥–ª—è —Ä–∏–∫–æ—à–µ—Ç–æ–≤.'],
      'Piper':['–ú–µ–Ω—è–π –¥–∏—Å—Ç–∞–Ω—Ü–∏—é, –ª–æ–º–∞–π –ø—Ä–µ–¥–∏–∫—Ç —Å–æ–ø–µ—Ä–Ω–∏–∫–∞.','–î–µ—Ä–∂–∏ ¬´Auto Aimer¬ª –ø–æ–¥ –ø—Ä—ã–∂–∫–∏ –∞—Å—Å–∞—Å–∏–Ω–æ–≤.'],
      'Nani':['–£–ª—å—Ç–∞ ¬´Peep¬ª ‚Äî –ø–æ–¥ —É–≥–ª–æ–≤–æ–π –¥–æ–±–æ—Ä –∫—ç—Ä—Ä–∏–µ—Ä–∞ –≥–µ–º–æ–≤.'],
      'General':['–ù–µ –º–µ–Ω—è–π—Å—è 1‚Äë–≤‚Äë1 –±–µ–∑ —Ü–µ–ª–∏: –≤–∞–∂–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—Ä—Ç—ã/–æ–±—ä–µ–∫—Ç–∞.']
    };
    const pickDistinct=(arr,k)=>{const c=arr.slice(),o=[];while(c.length&&o.length<k){o.push(c.splice(Math.floor(Math.random()*c.length),1)[0]);}return o;};
    function tipsForBrawler(name, targetScore, allMax, auditValGetter){
      if(allMax && targetScore>=9.2){
        const spec = specificTips[name]||[];
        return [...pickDistinct(spec, Math.min(2,spec.length)), ...pickDistinct(proTips, 4)];
      }
      const spec=specificTips[name]||[];
      const base=[...pickDistinct(spec,Math.min(2,spec.length)),...pickDistinct(generalTips,3)];
      const weak=[];
      const val=id=>parseInt(auditValGetter(id))||0;
      if(val('q1')<=4) weak.push('–¢—Ä–µ–Ω–∏—Ä—É–π —Ä—É—á–Ω–æ–µ –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞—Å—Ç–æ–º‚Äë–∫–∞—Ä—Ç–∞—Ö ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å —É—Å–∫–æ—Ä—è–µ—Ç—Å—è.');
      if(val('q11')<=6) weak.push('–ë–æ–ª—å—à–µ –∫–æ–ª–ª–æ–≤: —Ä–æ—Ç–∞—Ü–∏–∏ –∏ —Ç–∞–π–º–∏–Ω–≥–∏ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—Ç —Ç–∏–º—Ñ–∞–π—Ç—ã.');
      if(val('q12')<=6) weak.push('–ò–≥—Ä–∞ –ø–æ —Ü–µ–ª–∏ —Ä–µ–∂–∏–º–∞ –≤–∞–∂–Ω–µ–µ –ª–∏—à–Ω–∏—Ö –∫–∏–ª–ª–æ–≤.');
      if(val('q14')<=6) weak.push('–û—Ç—Å–ª–µ–∂–∏–≤–∞–π –±–æ–µ–ø—Ä–∏–ø–∞—Å—ã –≤—Ä–∞–≥–∞ ‚Äî –≤—Ä—ã–≤–∞–π—Å—è, –∫–æ–≥–¥–∞ –æ–Ω ¬´—Å—É—Ö–æ–π¬ª.');
      if(val('q15')<=6) weak.push('–£–ª—å—Ç–∞ ‚Äî —Ä–µ—Å—É—Ä—Å –ø–æ–¥ —Ç–∞–π–º–∏–Ω–≥, –∞ –Ω–µ –ø–æ–¥ —ç–º–æ—Ü–∏—é.');
      return [...base, ...pickDistinct(weak, 3)];
    }

    // --- 7. AUDIT + CALC (—Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –≤–µ—Å–∞–º–∏ –∏ Prestige-–±–æ–Ω—É—Å–æ–º) ---
    function computeAudit(){
      const selects=[...document.querySelectorAll('#screen-audit select.brawl-input')];
      const values=selects.map(s=>parseInt(s.value)||0);
      const raw=values.reduce((a,b)=>a+b,0);
      const max=selects.reduce((sum,s)=>sum+Math.max(...[...s.options].map(o=>parseInt(o.value)||0)),0);
      let norm=max? (raw/max)*10 : 0;

      if(state.mainBrawler){
        const a=getArchetype(state.mainBrawler.name);
        const V = (id)=>parseInt(getEl(id).value)||0;
        let bias=1.0;
        if(a==='sharpshooter') bias+=((V('q13')+V('q14'))/20)*0.10;
        else if(a==='assassin')  bias+=((V('q14')+V('q15'))/20)*0.08;
        else if(a==='thrower')   bias+=(V('q7')/10)*0.08;
        else if(a==='control')   bias+=(V('q12')/10)*0.08;
        else if(a==='support')   bias+=(V('q11')/10)*0.08;
        bias=Math.max(0.9,Math.min(1.1,bias));
        norm = Math.max(0,Math.min(10,norm*bias));
      }
      return norm;
    }

    function calculateResult(){
      if(!state.mainBrawler){ alert('–ú–µ–π–Ω –Ω–µ –≤—ã–±—Ä–∞–Ω. –í–µ—Ä–Ω–∏—Å—å –∏ –≤—ã–±–µ—Ä–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –±–æ–π—Ü–∞.'); return; }
      if(state.roster.length===0){ alert('–†–æ—Å—Ç–µ—Ä –ø—É—Å—Ç. –î–æ–±–∞–≤—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –±–æ–π—Ü–∞ 1000+.'); return; }
      AudioFX.beep('success');

      const weights = state.allMax ? {main:0.30, roster:0.40, audit:0.30} : {main:0.40, roster:0.30, audit:0.30};

      let mainScore = state.mainBrawler.diff;
      let sum=0; state.roster.forEach(r=>sum+=r.data.diff);
      let rosterAvg = state.roster.length? (sum/state.roster.length):0;
      const auditNorm = computeAudit();

      let finalRating = (mainScore*weights.main) + (rosterAvg*weights.roster) + (auditNorm*weights.audit);

      let penalty=false;
      if(state.mainBrawler.diff<=3){
        finalRating *= state.allMax ? 0.8 : 0.5;
        penalty=true;
      }

      if(state.allMax){
        let prestige = 1.6;
        if(auditNorm>=9) prestige += 0.6;
        if(state.roster.length>=90) prestige += 0.2;
        finalRating += prestige;
      }

      finalRating = Math.max(0,Math.min(10,finalRating));
      renderVerdict(finalRating.toFixed(1), penalty);
      nextScreen('screen-audit','screen-result');
    }

    function renderVerdict(score, penalty){
      const scoreEl=getEl('final-score'), title=getEl('verdict-title'), advice=getEl('advice-text');
      let current=0, target=parseFloat(score);
      const timer=setInterval(()=>{
        current=Math.min(target,current+0.1);
        scoreEl.innerText=current.toFixed(1)+"/10";
        AudioFX.beep('hover');
        if(current>=target){
          clearInterval(timer);
          scoreEl.innerText=score+"/10";
          if(target<4) scoreEl.style.color="var(--neon-red)";
          else if(target<7.5) scoreEl.style.color="var(--neon-cyan)";
          else scoreEl.style.color="var(--neon-gold)";
        }
      },20);

      let titleText="", body="";
      if(target>=9.2){
        titleText="MASTER TIER";
        body = `<p>–≠–ª–∏—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å. –ú–µ–π–Ω <strong>${state.mainBrawler.name}</strong>, —Ä–æ—Å—Ç–µ—Ä –∏ –∞—É–¥–∏—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã.</p>
                <p style='margin-top:10px'>Prestige‚Äë—Å—Ç–∞—Ç—É—Å —É—á—Ç—ë–Ω. –¢—ã –ø–æ—á—Ç–∏ –Ω–∞ –ø–æ—Ç–æ–ª–∫–µ —Å–∏—Å—Ç–µ–º—ã ‚Äî –¥–∞–ª—å—à–µ —Ç–æ–Ω–∫–∏–µ –º–∏–∫—Ä–æ‚Äë–∞–ø–¥–µ–π—Ç—ã.</p>`;
      }else if(target>=8.5){
        titleText="CYBER-SPORT ELITE";
        body = `<p>–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–∏–ª—å–Ω—ã–µ. –¢–≤–æ–π –º–µ–π–Ω <strong>${state.mainBrawler.name}</strong> –∏ —Ä–æ—Å—Ç–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∫.</p>
                <p style='margin-top:10px'>–ß—Ç–æ–±—ã –¥–æ–±–∏—Ç—å 9.2+, —Ä–∞–±–æ—Ç–∞–π –Ω–∞–¥ –º–µ–ª–æ—á–∞–º–∏: —Ç–∞–π–º–∏–Ω–≥–∏, —Ä–æ—Ç–∞—Ü–∏–∏, —á—Ç–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.</p>`;
      }else if(target>=6.0){
        titleText="SOLID FIGHTER";
        body = `<p>–•–æ—Ä–æ—à–∞—è –±–∞–∑–∞. –°—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –º–µ–π–Ω–∞: ${(state.mainBrawler.diff).toFixed(1)}.</p>
                <p style='margin-top:10px'><strong>–§–æ–∫—É—Å:</strong> —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏–π –ø–æ–¥ —Ü–µ–ª—å —Ä–µ–∂–∏–º–∞ –∏ –ø—Ä–µ–¥–∏–∫—Ç—ã.</p>`;
      }else{
        titleText="SKILL ISSUE DETECTED";
        body = `<p>–ù—É–∂–Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –ø–æ–∑–∏—Ü–∏–æ–Ω–∫–∞, –ø—Ä–µ–¥–∏–∫—Ç—ã –∏ —Ü–µ–ª–∏ —Ä–µ–∂–∏–º–∞ –ø–æ–¥ –∫–∞—Ä—Ç—ã.</p>`;
      }
      if(penalty){
        body += `<p style='margin-top:15px;color:var(--neon-red);border:1px solid var(--neon-red);padding:10px;'>‚ö† <strong>–®–¢–†–ê–§:</strong> –ú–µ–π–Ω –Ω–∏–∑–∫–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (${state.mainBrawler.name}). –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞${state.allMax?' (—Å–º—è–≥—á—ë–Ω–Ω–∞—è –¥–ª—è Prestige).':''}</p>`;
      }

      const tips = tipsForBrawler(
        state.mainBrawler.name,
        target,
        state.allMax,
        (id)=>getEl(id).value
      );
      const tipsHtml=tips.map(t=>`<li>${t}</li>`).join('');

      title.innerText=titleText;
      advice.innerHTML = body + `<ul style="margin-top:12px;padding-left:20px;line-height:1.4;">${tipsHtml}</ul>`;
    }

    // --- INIT ---
    document.addEventListener('DOMContentLoaded',()=>{
      wireAudio();
      bootStep(0);
    });
  </script>
</body>
</html>
``
